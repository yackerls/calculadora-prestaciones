<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Liquidación GT</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-8">

    <div class="max-w-2xl mx-auto bg-white p-6 rounded-lg shadow-lg">
        <h1 class="text-2xl font-bold text-gray-800 mb-6 border-b pb-2">Calculadora Laboral Guatemala</h1>

        <div class="grid grid-cols-1 gap-4 mb-6">
            
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700">Salario Nominal (Q)</label>
                    <input type="number" id="salario" value="14000" class="mt-1 block w-full border border-gray-300 rounded-md p-2 shadow-sm focus:ring-blue-500 focus:border-blue-500">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">Total Descuentos (IGSS/ISR/Otros)</label>
                    <input type="number" id="descuentos" value="1000" class="mt-1 block w-full border border-gray-300 rounded-md p-2">
                </div>
            </div>

            <div>
                <label class="block text-sm font-medium text-gray-700">Anticipo Quincena ya recibido (Q)</label>
                <input type="number" id="anticipo" value="4200" class="mt-1 block w-full border border-gray-300 rounded-md p-2 bg-yellow-50">
                <p class="text-xs text-gray-500 mt-1">Si ya pasó el día 15, ingresa lo que te depositaron.</p>
            </div>

            <div>
                <label class="block text-sm font-medium text-gray-700">Motivo de salida</label>
                <select id="motivo" class="mt-1 block w-full border border-gray-300 rounded-md p-2">
                    <option value="despido">Despido Injustificado (Con Indemnización)</option>
                    <option value="renuncia">Renuncia (Sin Indemnización)</option>
                </select>
            </div>

            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700">Fecha Inicio Labores</label>
                    <input type="date" id="fechaInicio" class="mt-1 block w-full border border-gray-300 rounded-md p-2">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700">Fecha Finalización</label>
                    <input type="date" id="fechaFin" class="mt-1 block w-full border border-gray-300 rounded-md p-2">
                </div>
            </div>
            
            <div>
                <label class="block text-sm font-medium text-gray-700">Días de vacaciones pendientes de pago</label>
                <input type="number" id="diasVacaciones" value="15" class="mt-1 block w-full border border-gray-300 rounded-md p-2">
            </div>

            <button onclick="calcular()" class="w-full bg-blue-600 text-white font-bold py-2 px-4 rounded hover:bg-blue-700 transition duration-200">
                Calcular Liquidación
            </button>
        </div>

        <div id="resultados" class="hidden bg-gray-50 p-4 rounded-lg border border-gray-200">
            <h3 class="text-lg font-semibold mb-3">Detalle del Pago Final</h3>
            
            <div class="space-y-2 text-sm">
                <div class="flex justify-between border-b pb-1">
                    <span>Indemnización:</span>
                    <span id="resIndemnizacion" class="font-mono font-bold">Q0.00</span>
                </div>
                <div class="flex justify-between border-b pb-1">
                    <span>Bono 14 (Proporcional):</span>
                    <span id="resBono14" class="font-mono">Q0.00</span>
                </div>
                <div class="flex justify-between border-b pb-1">
                    <span>Aguinaldo (Proporcional):</span>
                    <span id="resAguinaldo" class="font-mono">Q0.00</span>
                </div>
                <div class="flex justify-between border-b pb-1">
                    <span>Vacaciones Pendientes:</span>
                    <span id="resVacaciones" class="font-mono">Q0.00</span>
                </div>
                <div class="flex justify-between pt-2 text-blue-800 font-bold">
                    <span>SUBTOTAL PRESTACIONES:</span>
                    <span id="totalPrestaciones">Q0.00</span>
                </div>
            </div>

            <h3 class="text-lg font-semibold mt-6 mb-3">Sueldo del Mes Actual (Neto)</h3>
            <div class="space-y-2 text-sm">
                 <div class="flex justify-between">
                    <span>Sueldo Bruto Mes:</span>
                    <span id="resSueldoBruto" class="font-mono">Q0.00</span>
                </div>
                <div class="flex justify-between text-red-600">
                    <span>(-) Descuentos (IGSS/ISR/Otros):</span>
                    <span id="resDescuentos" class="font-mono">-Q0.00</span>
                </div>
                 <div class="flex justify-between text-red-600 border-b pb-1">
                    <span>(-) Anticipo Quincena:</span>
                    <span id="resAnticipo" class="font-mono">-Q0.00</span>
                </div>
                 <div class="flex justify-between pt-2 text-green-700 font-bold">
                    <span>RESTANTE A PAGAR DE SUELDO:</span>
                    <span id="totalSueldo">Q0.00</span>
                </div>
            </div>

            <div class="mt-6 p-4 bg-green-100 rounded text-center border border-green-300">
                <span class="block text-gray-600 text-sm">Total a recibir en Cheque/Transferencia</span>
                <span id="granTotal" class="text-3xl font-bold text-green-800">Q0.00</span>
            </div>
        </div>
    </div>

    <script>
        // Configurar fechas por defecto
        document.getElementById('fechaInicio').value = '2025-01-01'; // Ejemplo: Entraste hace 1 año
        document.getElementById('fechaFin').value = '2026-01-31';    // Ejemplo: Sales a fin de mes

        function calcular() {
            // Obtener valores
            const salario = parseFloat(document.getElementById('salario').value) || 0;
            const descuentos = parseFloat(document.getElementById('descuentos').value) || 0;
            const anticipo = parseFloat(document.getElementById('anticipo').value) || 0;
            const diasVacaciones = parseFloat(document.getElementById('diasVacaciones').value) || 0;
            const motivo = document.getElementById('motivo').value;
            
            const fechaInicio = new Date(document.getElementById('fechaInicio').value);
            const fechaFin = new Date(document.getElementById('fechaFin').value);

            // Cálculos de tiempo
            const diferenciaTiempo = fechaFin - fechaInicio;
            const diasLaborados = diferenciaTiempo / (1000 * 3600 * 24);
            const aniosLaborados = diasLaborados / 365;

            // 1. Indemnización (Solo si es despido)
            // Base: (Sueldo * 14) / 12 para incluir la parte proporcional de bonos en la base
            let indemnizacion = 0;
            if (motivo === 'despido') {
                const baseIndemnizacion = (salario * 14) / 12; 
                indemnizacion = baseIndemnizacion * aniosLaborados;
            }

            // 2. Bono 14 (Del 1 de Julio a la fecha de fin)
            // Lógica simplificada: calcular días desde el último 1 de julio
            let fechaBono = new Date(fechaFin.getFullYear() - 1, 6, 1); // 1 Julio del año anterior
            if (fechaFin.getMonth() >= 6) { 
                fechaBono = new Date(fechaFin.getFullYear(), 6, 1); // Si estamos post-julio, es este año
            }
            // Ajuste manual para el ejemplo (Julio 2025 a Ene 2026 son 7 meses aprox)
            // En un sistema real se usa una librería como moment.js o day.js para exactitud de días
            const mesesBono = 7; // Aproximado para Enero
            const bono14 = (salario / 12) * mesesBono;

            // 3. Aguinaldo (Del 1 de Diciembre a fecha fin)
            // Ajuste para el ejemplo (Dic 2025 a Ene 2026 son 2 meses)
            const mesesAguinaldo = 2; 
            const aguinaldo = (salario / 12) * mesesAguinaldo;

            // 4. Vacaciones
            // Fórmula: (Salario / 30 días) * Días pendientes
            const pagoVacaciones = (salario / 30) * diasVacaciones;

            // SUBTOTAL PRESTACIONES
            const totalPrestaciones = indemnizacion + bono14 + aguinaldo + pagoVacaciones;

            // 5. CÁLCULO DE SUELDO RESTANTE
            const sueldoLiquido = salario - descuentos;
            const restanteSueldo = sueldoLiquido - anticipo;

            // GRAN TOTAL
            const granTotal = totalPrestaciones + restanteSueldo;

            // Renderizar
            document.getElementById('resIndemnizacion').innerText = formatearQ(indemnizacion);
            document.getElementById('resBono14').innerText = formatearQ(bono14);
            document.getElementById('resAguinaldo').innerText = formatearQ(aguinaldo);
            document.getElementById('resVacaciones').innerText = formatearQ(pagoVacaciones);
            document.getElementById('totalPrestaciones').innerText = formatearQ(totalPrestaciones);

            document.getElementById('resSueldoBruto').innerText = formatearQ(salario);
            document.getElementById('resDescuentos').innerText = '-' + formatearQ(descuentos);
            document.getElementById('resAnticipo').innerText = '-' + formatearQ(anticipo);
            document.getElementById('totalSueldo').innerText = formatearQ(restanteSueldo);

            document.getElementById('granTotal').innerText = formatearQ(granTotal);
            
            document.getElementById('resultados').classList.remove('hidden');
        }

        function formatearQ(monto) {
            return 'Q' + monto.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,');
        }
    </script>
</body>
</html>